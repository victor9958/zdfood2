<!-- 校区管理 -->
<style>
    .wrapper .layui-input-inline {
        margin-bottom: 12px;
    }

    .btn-bar {
        background: #f7f8fa;
        padding: 4px 10px;
    }

    .ml {
        margin-left: 10px;
    }
</style>
<title>校区管理</title>
<div class='wrapper layui-fluid full-height '>
    <div class='layui-card full-height over-auto'>
        <!-- //上面的head，标题 -->
        <div class="layui-card-header">校区管理</div>
        <!-- //content身体部分 -->
        <div class='layui-card-body'>
            <div class="m-b-10 btn-bar">
                <button class="layui-btn ml layui-btn-sm" id='data-syne'>数据同步</button>
            </div>
            <table id="orderListTable" lay-filter="orderListTable"></table>
        </div>
    </div>
</div>
<script>
    layui.use(['admin', 'form', 'laydate', 'table'], function () {
        var $ = layui.$,
            admin = layui.admin,
            table = layui.table,
            view = layui.view,
            setter = layui.setter,
            form = layui.form,
            laydate = layui.laydate,
            upload = layui.upload;
        $(function () {
            form.render();
            var cols = [[
                {type: 'numbers', title: '序号', width: 60 },
                { field: 'name', title: '名称' },
                { field: 'address', title: '地址' },
                { field: 'canteens_count', title: '食堂数量' },
                { field: 'admins_count', title: '员工数量' },
            ]];
            getRtable();
            function getRtable() {
                table.render({
                    elem: '#orderListTable',
                    url: setter.baseUrl + '/system/site/campuses',
                    response: setter.responseTable,
                    page: setter.pageTable,
                    loading: false,
                    cols: cols
                });
            }
            // 数据同步事件
            $(document).off('click', '#data-syne');
            $(document).on('click', '#data-syne', function () {
                admin.req({
                    //请求接口
                    url: setter.baseUrl + '/system/site/campuses-sync',
                    type: 'put',
                    data: {},
                    done: function (res) {
                        view('old_mobile')
                        layer.msg(res.message, { icon: 1, time: 2000 });
                        layer.close(admin.popup.index);//关闭右侧面板
                        getRtable();
                    }
                });
            })
        });
    });
</script>