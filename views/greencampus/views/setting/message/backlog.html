<title>待办事项</title>
<div class="layui-fluid layui-border-box full-height">
    <div class="layui-card full-height">
        <div class="layui-card-header fixed-header">待办事项</div>
        <div class="layui-card-body layui-clear full-height over-auto card-body">
            <div id="backlog_" class="layui-table" lay-filter="backlog_"></div>
        </div>
    </div>
</div>

<script type="text/html" id="backlog_option">
    <a class="layui-btn layui-btn-xs" lay-event="toExamine">去审核</a>
    <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="backlog_detail">详情</a>
</script>
<script type="text/html" id="isVisit">
    {{#  if(!d.visit){ }}
    <span class="layui-badge-dot" id="dot-{{d.id}}" style="margin-right:10px;"></span>
    {{#  } }}
</script>

<script>
    layui.use('table', function () {
        var $ = layui.$,
            view = layui.view,
            admin = layui.admin,
            table = layui.table,
            setter = layui.setter;

        $(function () {
            table.render({
                id: 'backlog_'
                , elem: '#backlog_'
                , url: setter.baseUrl + '/news-center/todo' //模拟接口
                , page: setter.pageTable
                , cellMinWidth: 100
                , loading: false
                , limit: setter.limit
                , response: setter.responseTable
                , cols: [[
                    {type: 'numbers', title: '序号', width: 60}
                    ,{width: 16, templet: '#isVisit'}
                    , {field: 'title', title: '待办事项'}
                    , {field: 'created_at', title: '时间', width: 240}
                    , {title: '操作', width: 180, toolbar: '#backlog_option'}
                ]]
                , skin: 'line'
            });

            table.on('tool(backlog_)', function (obj) {
                var data = obj.data;
                layui.data('temporary', {
                    key: 'temporary'
                    , value: {'news_id': data.id, type: 'todo'}
                });
                if (obj.event === 'backlog_detail') {
                    admin.popupCenter({
                        id: 'LAY_adminPopupNewsDetail'
                        , title: '详情'
                        , area: ['430px', '520px']
                        , success: function () {
                            view(this.id).render('setting/message/news/detail');
                        }
                    });
                }
            });
        })
    });
</script>