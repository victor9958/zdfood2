<style>
    .centerLayer .get-verify {
        width: 90px;
        color: #0fcfbb;
        line-height: 38px;
        padding-left: 0;
        border-left: 1px solid #e6e6e6;
        text-align: center;
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
        position: absolute;
        right: 0;
        top: 0;
    }
</style>
<div class="layui-form centerLayer">
    <div class="layui-form-item">
        <label class="layui-form-label left">新手机号</label>
        <div class="layui-input-block">
            <input type="text" name="mobile" id="mobile" lay-verify="phone" autocomplete="off" placeholder="请输入新的手机号码" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label left">验证码</label>
        <div class="layui-input-block relative_">
            <input type="text" name="smsCode" lay-verify="required" autocomplete="off" placeholder="请输入验证码" class="layui-input">
            <a href="javascript:;" class="get-verify layui-input">获取验证码</a>
        </div>
    </div>

    <div class="layui-form-item p-t-10 ft-center">
        <button class="layui-btn" lay-submit lay-filter="LAY-reset-mobile">确定</button>
        <button class="layui-btn layui-btn-primary" id="cancel">取消</button>
    </div>
</div>
<script>
    layui.use(['form'], function(){
        var $ = layui.$,
            admin = layui.admin,
            setter = layui.setter,
            form = layui.form;

        var password = '';
        $(function(){
            // 点击获取验证码
            var verifyTag = true;
            var mobile = '';
            var phone_test = /^1[2-9]+\d{9}$/;
            $(document).on('click', '.get-verify', function (e) {
                e.preventDefault();
                if (verifyTag) getCode(this);
                else return;
            });

            //倒计时
            function timeCountDown(elem, seconds) {
                verifyTag = false;
                if (typeof seconds == undefined || seconds == null) seconds = 60;
                $(elem).text('已发送 ' + seconds + 's').addClass('disabled');
                setTimeout(function () {
                    if (seconds > 0) {
                        seconds--;
                        $(elem).text('已发送 ' + seconds + 's').addClass('disabled');
                        timeCountDown(elem, seconds);
                    } else {
                        $(elem).removeClass('disabled').text('获取验证码');
                        verifyTag = true;
                    }
                }, 1000);
            }

            function getCode(elem) {
                mobile = $('#mobile').val();
                if (!phone_test.test(mobile)) {
                    layer.msg('请输入正确的手机号', {
                        icon: 5
                    });
                } else {
                    admin.req({
                        url: setter.baseUrl + '/auth/sms-code' //实际使用请改成服务端真实接口
                        , data: {'mobile': mobile}
                        , type: 'get'
                        , done: function (res) {
                            timeCountDown(elem);
                            layer.msg('已成功获取验证码', {
                                icon: 1
                                , time: 1000
                            });
                        }
                    });
                }
            }

        })
    })
</script>